<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claude Sessions</title>
    <link rel="stylesheet" href="styles.css?v=5">
</head>
<body>
    <header>
        <h1>Claude Code Sessions</h1>
        <div id="status">
            <span id="session-count">0 sessions</span>
            <span id="last-update">--</span>
            <button id="sound-toggle" class="icon-button" onclick="soundManager.toggle(); soundManager.updateMuteIndicator(); showToast(soundManager.enabled ? 'ğŸ”Š Sound enabled' : 'ğŸ”‡ Sound muted');" title="Toggle sound (M)">
                ğŸ”Š
            </button>
            <button id="sound-settings" class="icon-button" onclick="showSoundSettings()" title="Sound settings (Shift+S)">
                âš™ï¸
            </button>
            <button id="analytics-button" class="icon-button" title="Analytics" onclick="toggleAnalytics()">
                ğŸ“Š
            </button>
            <button id="machines-button" class="icon-button" title="Manage machines" onclick="showMachinesModal()">
                ğŸ–¥ï¸
            </button>
            <span id="machine-count" class="machine-count"></span>
            <button id="notification-toggle" class="icon-button" title="Toggle notifications">
                ğŸ””
            </button>
            <button id="help-button" class="icon-button" title="Keyboard shortcuts (?)">
                ?
            </button>
        </div>
    </header>

    <nav class="view-tabs">
        <button class="tab-button active" onclick="switchView('sessions')" data-view="sessions">
            Sessions
        </button>
        <button class="tab-button" onclick="switchView('gastown')" data-view="gastown">
            ğŸ­ Gastown
        </button>
        <button class="tab-button" onclick="switchView('timeline')" data-view="timeline">
            Timeline
        </button>
        <button class="tab-button" onclick="switchView('analytics')" data-view="analytics">
            Analytics
        </button>
        <button class="tab-button" onclick="switchView('mission-control')" data-view="mission-control">
            ğŸ¯ Mission Control
        </button>
    </nav>

    <div id="sessions-view" class="view active">
        <div id="filters">
            <input type="text" id="search" placeholder="ğŸ” Search sessions...">
            <select id="status-filter">
                <option value="all">All Sessions</option>
                <option value="active">Active Only</option>
                <option value="waiting">Waiting Only</option>
            </select>
            <button id="clear-filters">Clear</button>
            <div class="filter-divider"></div>
            <button id="view-mode-toggle" class="icon-button" onclick="toggleCardMode()" title="Toggle compact/detailed view (v)">ğŸ“‹</button>
            <button id="focus-mode-toggle" class="icon-button" onclick="toggleFocusMode()" title="Focus on active sessions (f)">ğŸ¯</button>
            <button id="refresh-all-summaries" class="icon-button" onclick="refreshAllSummaries()" title="Refresh all AI summaries">ğŸ¤–</button>
        </div>
        <main id="sessions-container"></main>
    </div>

    <div id="gastown-view" class="view">
        <div class="gastown-view-header">
            <h2>ğŸ­ Gastown Agents</h2>
            <span id="gastown-count" class="gastown-stats"></span>
        </div>
        <main id="gastown-container"></main>
    </div>

    <div id="timeline-view" class="view">
        <div class="timeline-header">
            <h2>Session Timeline</h2>
            <div class="timeline-controls">
                <select id="timeline-range-select" onchange="changeTimelineRange(this.value)">
                    <option value="4">Last 4 hours</option>
                    <option value="8" selected>Last 8 hours</option>
                    <option value="24">Last 24 hours</option>
                    <option value="48">Last 48 hours</option>
                    <option value="168">Last 7 days</option>
                </select>
                <button class="refresh-btn" onclick="refreshTimeline()" title="Refresh timeline">ğŸ”„</button>
            </div>
        </div>
        <div class="timeline-legend">
            <span class="legend-item"><span class="legend-dot active"></span> Active</span>
            <span class="legend-item"><span class="legend-dot waiting"></span> Waiting</span>
        </div>
        <div id="timeline-container" class="timeline-container">
            <div class="timeline-loading">Loading timeline...</div>
        </div>
    </div>

    <div id="analytics-view" class="view">
        <div class="analytics-header">
            <h2>Usage Analytics</h2>
            <div class="period-selector">
                <button class="period-btn" data-period="day">Today</button>
                <button class="period-btn active" data-period="week">Week</button>
                <button class="period-btn" data-period="month">Month</button>
                <button class="period-btn" data-period="year">Year</button>
            </div>
        </div>
        <div id="analytics-container"></div>
    </div>

    <div id="mission-control-view" class="view">
        <div class="mission-control-header">
            <h2>ğŸ¯ Mission Control</h2>
            <div class="mission-control-stats">
                <span id="mc-active-count">0 active</span>
                <span id="mc-waiting-count">0 waiting</span>
            </div>
        </div>
        <div id="mission-control-container">
            <div class="mc-session-panel">
                <h3>Sessions</h3>
                <div id="mc-session-list" class="mc-session-list">
                    <p class="mc-placeholder">Select a session to monitor</p>
                </div>
            </div>
            <div class="mc-main-panel">
                <div id="mc-conversation-stream" class="mc-conversation-stream">
                    <p class="mc-placeholder">Real-time conversation will appear here</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for keyboard shortcuts and other dialogs -->
    <div id="modal-overlay" class="modal-overlay hidden">
        <div id="modal-content" class="modal-content"></div>
    </div>
    <script src="app.js?v=9"></script>
</body>
</html>
